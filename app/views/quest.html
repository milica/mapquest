<header title="{{ view.quest.name }}"></header>

<div class="screen quest" ng-class="{loading: view.loading}" ng-switch="view.tab">

    <div class="toolbar tabs">
        <a href class="btn block" ng-class="{active: view.tab === 'info'}" ng-click="switchTab('info')"><i class="fa fa-info"></i> Info</a>
        <a href class="btn block" ng-class="{active: view.tab === 'map'}" ng-click="switchTab('map')"><i class="fa fa-map-marker"></i> Map</a>
    </div>

    <div class="tab" ng-switch-when="info">

        <div class="info-row">
            <div class="label">Quest</div>
            <div class="info">
                <h2>{{ view.quest.name }}</h2>
            </div>
        </div>

        <div class="info-row">
            <div class="label">Status</div>
            <div class="info">
                <span class="status-text">{{ view.quest.status }} <span class="status {{ view.quest.status }}"><i class="fa fa-circle"></i></span></span>
            </div>
        </div>

        <div class="info-row">
            <div class="label">Start Date</div>
            <div class="info"><span class="date">{{ view.quest.startDate | date:'dd/MM/yyyy' }}</span></div>
        </div>

        <div class="info-row">
            <div class="label">Finish Date</div>
            <div class="info"><span class="date">{{ view.quest.finishDate | date:'dd/MM/yyyy' }}</span></div>
        </div>

        <div ng-if="view.participant" class="info-row">
            <div class="label">Score</div>
            <div class="info">
                <span class="score">{{ view.participant.score }} / {{ view.participant.path.length }}</span>
            </div>
        </div>

        <div ng-if="view.participant" class="info-row">
            <div class="label">Rank</div>
            <div class="info">
                <span class="rank">{{ view.participant.rank }}</span>
            </div>
        </div>

        <div class="info-row">
            <div class="label">Participants</div>
            <div class="info">
                <a class="btn block white" href><i class="fa fa-chevron-right"></i></a>
            </div>
        </div>

        <div class="action" ng-if="view.quest.status !== 'finished'">
            <button ng-if="!view.participant" ng-click="join()" ng-disabled="view.saving" class="btn green block">Join</button>
            <button ng-if="view.participant" ng-click="quit()" ng-disabled="view.saving" class="btn brown block">Quit</button>
        </div>

    </div>
    <div class="tab" ng-switch-when="map">
        <div class="map" map></div>

        <div class="map-actions">
            <a class="btn block"><i class="fa fa-arrows"></i> show all</a>
            <a class="btn block"><i class="fa fa-crosshairs"></i> location</a>
        </div>
    </div>

    <div ng-if="view.participant" modal="modal-confirm" message="Are you sure you want to quit the quest?" modal-show="view.showModal.quit" handle="hideConfirmQuit()" handle-ok="confirmQuit()"></div>
    <div modal="modal-joined" message="Congrats! Now get out and conquer some places!" modal-show="view.showModal.join" handle="hideConfirmJoin()"></div>

</div>